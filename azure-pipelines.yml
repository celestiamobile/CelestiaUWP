resources:
 repositories:
  - repository: Celestia
    type: github
    endpoint: GithubAuth
    name: celestiamobile/Celestia
  - repository: CelestiaContent
    type: github
    endpoint: GithubAuth
    name: CelestiaProject/CelestiaContent
  - repository: CelestiaLocalization
    type: github
    endpoint: GithubAuth
    name: celestiamobile/CelestiaLocalization

trigger:
- main
- develop

stages:
- stage: Build_MSIX_X64
  displayName: 'Build MSIX x64'
  jobs:
  - template: jobs/build.yml
    parameters:
      buildType: msixupload
      arch: x64

- stage: Build_MSIX_ARM64
  displayName: 'Build MSIX arm64'
  dependsOn: []
  jobs:
  - template: jobs/build.yml
    parameters:
      buildType: msixupload
      arch: arm64

- stage: Build_Sideload_X64
  displayName: 'Build Sideload x64'
  dependsOn: []
  jobs:
  - template: jobs/build.yml
    parameters:
      buildType: sideload
      arch: x64

- stage: Build_Sideload_ARM64
  displayName: 'Build Sideload arm64'
  dependsOn: []
  jobs:
  - template: jobs/build.yml
    parameters:
      buildType: sideload
      arch: arm64

- stage: Publish_Sideload
  displayName: 'Publish Sideload'
  dependsOn:
  - Build_Sideload_X64
  - Build_Sideload_ARM64
  jobs:
  - template: jobs/publish.yml

- stage: Bundle_MSIX
  displayName: 'Bundle MSIX'
  dependsOn:
  - Build_MSIX_X64
  - Build_MSIX_ARM64
  jobs:
  - template: jobs/bundle.yml